"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[268],{2718:(e,r,t)=>{t.d(r,{C:()=>c,W:()=>i});var o=t(5155),a=t(2115),l=t(5695),n=t(7123);let s=(0,a.createContext)(void 0),i=e=>{let{children:r}=e,[t,i]=(0,a.useState)(""),[c,d]=(0,a.useState)(""),[u,m]=(0,a.useState)("All Items"),[h,p]=(0,a.useState)("0"),[f,g]=(0,a.useState)([]),[w,y]=(0,a.useState)(""),[b,v]=(0,a.useState)([]),E=(0,l.useRouter)();(0,a.useEffect)(()=>{j(),x(),k(),console.log(t)},[]);let j=async()=>{let e=sessionStorage.getItem("userId");if(!e)return void E.push("/login");try{let r=await fetch("".concat(n.J,"/api/users/").concat(e),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(r.ok){let e=await r.json();console.log("Account recuperato:",e),console.log("Password decriptata dal backend:",e.password),i(e.email),d(e.password)}else console.error("Errore nel recupero dell'account:",r.statusText)}catch(e){console.error("Errore durante il recupero dell'account:",e)}},x=async()=>{let e=sessionStorage.getItem("userId");if(!e)return void E.push("/login");try{let r=await fetch("".concat(n.J,"/api/folders?user_id=").concat(e),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(r.ok){let t=await r.json();console.log("Cartelle recuperate dal backend:",t.folders);let o=t.folders.map(r=>({id:r.id,label:r.name,account:r.created_by,shared:r.shared,editable:r.created_by===e,sharedWith:r.shared_with||[],ownerEmail:r.owner_email}));g(o)}else console.error("Errore nel recupero delle cartelle:",r.statusText)}catch(e){console.error("Errore durante il recupero delle cartelle:",e)}},k=async()=>{let e=sessionStorage.getItem("userId");if(!e)return void E.push("/login");try{let r=await fetch("".concat(n.J,"/api/items?user_id=").concat(e),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(r.ok){let e=await r.json();console.log("Elementi recuperati (tutti):",e),v(e.items.map(e=>({id:e.id,tag:e.tag,website:e.website,username:e.username,password:e.password,securityLevel:e.securityLevel||"unknown",folderID:e.folderId||"0",account:e.user_id,sharedFolder:e.shared||!1})))}else console.error("Errore nel recupero degli elementi:",r.statusText)}catch(e){console.error("Errore durante il recupero degli elementi:",e)}},C=async function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=sessionStorage.getItem("userId");if(!o)return void E.push("/login");try{let a=await fetch("".concat(n.J,"/addFolder"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,user_id:o,shared:r})}),l=await a.json();a.ok?(console.log("Cartella aggiunta:",l),g(o=>[...o,{id:l.folder_id,label:e,account:t,shared:r,editable:!0,sharedWith:[],ownerEmail:t}])):console.error("Errore dal server:",l.error)}catch(e){console.error("Errore durante la creazione della cartella:",e)}},S=async e=>{let r=sessionStorage.getItem("userId");if(!r)return void E.push("/login");try{let t=await fetch("".concat(n.J,"/addItem"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:r,tag:e.tag,username:e.username,password:e.password,website:e.website,folder_id:e.folderID})}),o=await t.json();t.ok?(console.log("Item aggiunto:",o),k()):console.error("Errore dal server:",o.error)}catch(e){console.error("Errore durante l'aggiunta dell'elemento:",e)}},N=async(e,r)=>{let t=f.find(r=>r.id===e);if(!t)return;let o={...r};"label"in o&&(o.name=o.label,delete o.label);try{if((await fetch("".concat(n.J,"/updateFolder/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},mode:"cors",credentials:"include",body:JSON.stringify(o)})).ok){console.log("Cartella aggiornata con successo");let o={...t,...r};g(f.map(r=>r.id===e?o:r))}else console.error("Errore durante l'aggiornamento della cartella")}catch(e){console.error("Errore durante l'aggiornamento della cartella:",e)}},T=async e=>{try{let r=await fetch("".concat(n.J,"/updateItem/").concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({tag:e.tag,website:e.website,username:e.username,password:e.password,folder_id:e.folderID})}),t=await r.json();r.ok?(console.log("Elemento aggiornato:",t),v(r=>r.map(r=>r.id===e.id?{...r,...e,securityLevel:t.securityLevel}:r)),k()):console.error("Errore durante l'aggiornamento dell'elemento:",t.error)}catch(e){console.error("Errore durante l'aggiornamento dell'elemento:",e)}},I=async e=>{try{let r=await fetch("".concat(n.J,"/deleteFolder/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"}});if(r.ok)console.log("Cartella eliminata con successo"),g(r=>r.filter(r=>r.id!==e)),v(r=>r.filter(r=>r.folderID!==e)),m(r=>r===e?"All Items":r);else{let e=await r.json();console.error("Errore durante l'eliminazione della cartella:",e.error)}}catch(e){console.error("Errore durante l'eliminazione della cartella:",e)}},J=async e=>{try{let r=await fetch("".concat(n.J,"/deleteItem/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json"}});if(r.ok)console.log("Elemento eliminato con successo"),v(r=>r.filter(r=>r.id!==e));else{let e=await r.json();console.error("Errore durante l'eliminazione dell'elemento:",e.error)}}catch(e){console.error("Errore durante l'eliminazione dell'elemento:",e)}},_=async(e,r)=>{try{let t=await fetch("".concat(n.J,"/share"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,folderId:r})});if(t.ok){let e=await t.json();return console.log("Cartella condivisa con successo:",e),{success:!0,message:e.message}}{let e=await t.json();return console.error("Errore durante la condivisione della cartella:",e.error),{success:!1,message:e.error}}}catch(e){return console.error("Errore durante la condivisione della cartella:",e),{success:!1,message:"Errore di rete"}}},P=async(e,r)=>{g(t=>t.map(t=>t.id===e?{...t,sharedWith:t.sharedWith.filter(e=>e!==r)}:t));try{let t=await fetch("".concat(n.J,"/api/folders/").concat(e,"/remove-shared-user"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r}),credentials:"include"});if(!t.ok){let e=await t.json();console.error("Errore durante la rimozione della condivisione:",e.error)}}catch(e){console.error("Errore durante la rimozione della condivisione:",e)}},A=async(e,r,t)=>{if(r!==t)return{success:!1,error:"Le nuove password non coincidono."};let o=sessionStorage.getItem("userId");if(!o)return{success:!1,error:"Utente non loggato."};try{let t=await fetch("".concat(n.J,"/api/users/").concat(o,"/password"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({oldPassword:e,newPassword:r}),credentials:"include"});if(t.ok)return d(r),{success:!0};{let e=await t.json();return{success:!1,error:e.error||"Errore durante l'aggiornamento della password."}}}catch(e){return{success:!1,error:"Errore di rete."}}};return(0,o.jsx)(s.Provider,{value:{selection:u,account:t,setAccount:i,setSelection:m,ID:h,setID:p,folders:f,setFolders:g,items:b,setItems:v,getFolders:x,getItems:k,postFolder:C,postItem:S,updateFolder:N,updateItem:T,deleteFolder:I,deleteItem:J,searchTerm:w,setSearchTerm:y,shareFolderWithUser:_,removeSharedFolderForUser:P,password:c,setPassword:d,changePassword:A},children:r})},c=()=>{let e=(0,a.useContext)(s);if(!e)throw Error("useSelection must be used within a SelectionProvider");return e}},4408:(e,r,t)=>{t.d(r,{A:()=>i});var o=t(5155),a=t(9946);let l=(0,a.A)("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]),n=(0,a.A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);var s=t(2718);function i(){let{searchTerm:e,setSearchTerm:r,selection:t}=(0,s.C)();return(0,o.jsx)("div",{className:"h-[5rem] py-[1rem] pl-[0.8rem] md:h-[4rem] w-full md:pl-[1rem] md:pr-[1rem] md:pt-[1rem] md:pb-[1rem]",children:(0,o.jsxs)("div",{className:"h-full w-full flex items-center relative",children:[(0,o.jsx)("div",{className:"flex mr-4 md:hidden items-center gap-2",children:(0,o.jsx)(l,{className:"text-gray-600 w-10 h-10",onClick:()=>{window.dispatchEvent(new Event("show-sidebar"))}})}),(0,o.jsxs)("div",{className:"".concat("Password Generator"===t||"Settings"===t?"hidden md:flex":"flex"," w-full h-10 md:h-full items-center relative"),children:[(0,o.jsx)(n,{className:"absolute md:top-1 top-2 md:left-2 left-3 text-gray-600 w-6 h-6"}),(0,o.jsx)("form",{action:"",className:"h-full w-full",onSubmit:e=>e.preventDefault(),children:(0,o.jsx)("input",{className:"border-1 bg-white border-gray-600 h-full w-full rounded-3xl pl-[2.5rem] pr-[1rem] outline-none md:text-base text-2xl",type:"text",placeholder:"Search",value:e,onChange:e=>{r(e.target.value)}})})]})]})})}},5695:(e,r,t)=>{var o=t(8999);t.o(o,"useRouter")&&t.d(r,{useRouter:function(){return o.useRouter}}),t.o(o,"useSearchParams")&&t.d(r,{useSearchParams:function(){return o.useSearchParams}})},6141:(e,r,t)=>{t.d(r,{A:()=>l});var o=t(5155),a=t(7650);function l(e){let{folderName:r,onConfirm:t,onCancel:l}=e,n=(0,o.jsx)("div",{className:"fixed inset-0 z-50 bg-black/30 backdrop-blur-sm flex items-center justify-center",children:(0,o.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg w-[90%] max-w-md text-center",children:[(0,o.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Are you sure you want to delete “",r,"”?"]}),(0,o.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,o.jsx)("button",{onClick:l,className:"px-4 py-2 rounded bg-blue-200 hover:bg-blue-300 text-gray-800",children:"Cancel"}),(0,o.jsx)("button",{onClick:t,className:"px-4 py-2 rounded bg-blue-200 hover:bg-blue-300 text-gray-800",children:"Delete"})]})]})});return a.createPortal(n,document.body)}},7123:(e,r,t)=>{t.d(r,{J:()=>o});let o=t(9509).env.NEXT_PUBLIC_API_URL||"http://localhost:8000"},9946:(e,r,t)=>{t.d(r,{A:()=>u});var o=t(2115);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,t)=>t?t.toUpperCase():r.toLowerCase()),n=e=>{let r=l(e);return r.charAt(0).toUpperCase()+r.slice(1)},s=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()},i=e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0};var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,o.forwardRef)((e,r)=>{let{color:t="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:n,className:d="",children:u,iconNode:m,...h}=e;return(0,o.createElement)("svg",{ref:r,...c,width:a,height:a,stroke:t,strokeWidth:n?24*Number(l)/Number(a):l,className:s("lucide",d),...!u&&!i(h)&&{"aria-hidden":"true"},...h},[...m.map(e=>{let[r,t]=e;return(0,o.createElement)(r,t)}),...Array.isArray(u)?u:[u]])}),u=(e,r)=>{let t=(0,o.forwardRef)((t,l)=>{let{className:i,...c}=t;return(0,o.createElement)(d,{ref:l,iconNode:r,className:s("lucide-".concat(a(n(e))),"lucide-".concat(e),i),...c})});return t.displayName=n(e),t}}}]);